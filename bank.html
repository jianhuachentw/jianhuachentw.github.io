<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¿æ½” & ç›ˆå®‰é›†é»éŠ€è¡Œ</title>
    <style>
        :root { --main-color: #00796b; --bg-color: #e0f2f1; }
        body { font-family: -apple-system, "Microsoft JhengHei", sans-serif; background: var(--bg-color); padding: 15px; color: #333; transition: 0.3s; }
        .card { max-width: 500px; margin: auto; background: white; padding: 20px; border-radius: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        .tabs { display: flex; margin-bottom: 20px; gap: 10px; }
        .tab { flex: 1; padding: 12px; text-align: center; background: #eee; border-radius: 12px; cursor: pointer; font-weight: bold; font-size: 1.1em; border: 2px solid transparent; }
        .tab.active[data-child="yujie"] { background: #00796b; color: white; border-color: #004d40; }
        .tab.active[data-child="yingan"] { background: #673ab7; color: white; border-color: #4527a0; }
        h2 { text-align: center; color: var(--main-color); margin-top: 0; }
        .bank-balance { font-size: 1.2em; color: #d32f2f; font-weight: bold; margin-bottom: 15px; background: #fff5f5; padding: 8px; border-radius: 10px; display: inline-block; width: 100%; box-sizing: border-box; }
        .item { display: flex; justify-content: space-between; align-items: center; padding: 10px 0; border-bottom: 1px solid #f0f0f0; }
        .pts { color: #f57c00; font-weight: bold; font-size: 0.9em; margin-right: 5px; }
        .score-zone { text-align: center; background: #f9f9f9; padding: 15px; border-radius: 15px; margin: 15px 0; border: 2px solid #ddd; }
        #total-score { font-size: 2.2em; color: var(--main-color); display: block; font-weight: bold; }
        button { width: 100%; padding: 12px; border: none; border-radius: 10px; font-size: 16px; cursor: pointer; margin-top: 10px; font-weight: bold; }
        .btn-settle { background: var(--main-color); color: white; box-shadow: 0 4px #004d40; }
        .btn-settle:active { transform: translateY(2px); box-shadow: 0 2px #004d40; }
        .btn-reset { background: #f5f5f5; color: #9e9e9e; font-size: 0.8em; margin-top: 15px; }
        .history-title { margin-top: 25px; display: block; border-left: 4px solid var(--main-color); padding-left: 10px; font-weight: bold; }
        .history-item { font-size: 0.85em; padding: 10px; background: #f9f9f9; border-radius: 8px; margin-top: 8px; display: flex; justify-content: space-between; align-items: center; border: 1px solid #eee; }
        .del-btn { color: #ff5252; cursor: pointer; padding: 5px 10px; border: 1px solid #ffcdd2; border-radius: 5px; background: white; }
        input[type="checkbox"] { width: 24px; height: 24px; cursor: pointer; }
    </style>
</head>
<body>

<div class="card">
    <div class="tabs">
        <div id="tab-yujie" class="tab active" data-child="yujie" onclick="switchChild('yujie')">ä¿æ½”</div>
        <div id="tab-yingan" class="tab" data-child="yingan" onclick="switchChild('yingan')">ç›ˆå®‰</div>
    </div>

    <h2 id="child-title">ä¿æ½” çš„é›†é»å¡</h2>
    
    <div style="text-align: center;">
        <div class="bank-balance">ğŸ’° éŠ€è¡Œé¤˜é¡ï¼š<span id="bank-val">0</span> å…ƒ</div>
    </div>

    <div id="task-list">
        <div class="item"><span>æ”¶æ‹¾ç©å…·</span><div><span class="pts">+1</span><input type="checkbox" class="cb" data-pts="1"></div></div>
        <div class="item"><span>æ•´ç†æ›¸åŒ…</span><div><span class="pts">+1</span><input type="checkbox" class="cb" data-pts="1"></div></div>
        <div class="item"><span>é¤ç›¤æ”¾æ°´æ§½</span><div><span class="pts">+1</span><input type="checkbox" class="cb" data-pts="1"></div></div>
        <div class="item"><span>ä¾¿ç•¶æ”¾æ°´æ§½</span><div><span class="pts">+1</span><input type="checkbox" class="cb" data-pts="1"></div></div>
        <div class="item"><span>è«‹å®¶é•·ç°½å</span><div><span class="pts">+1</span><input type="checkbox" class="cb" data-pts="1"></div></div>
        <div class="item"><span>20:00å‰å®Œæˆä½œæ¥­</span><div><span class="pts">+1</span><input type="checkbox" class="cb" data-pts="1"></div></div>
        <div class="item"><span>é ç¿’åŠŸèª²</span><div><span class="pts">+2</span><input type="checkbox" class="cb" data-pts="2"></div></div>
        <div class="item"><span>è®€å®Œ2æœ¬èª²å¤–æ›¸(é€±)</span><div><span class="pts">+2</span><input type="checkbox" class="cb" data-pts="2"></div></div>
        <div class="item"><span>å®Œæˆè‡ªä¿®ä¸€å–®å…ƒ(é€±)</span><div><span class="pts">+2</span><input type="checkbox" class="cb" data-pts="2"></div></div>
    </div>

    <div class="score-zone">
        æœ¬é€±ç›®å‰ç´¯è¨ˆ <span id="total-score">0</span>
        <small style="color:#666">10é»æ›é›»è¦– | 30é»æ›å¹³æ¿</small>
    </div>

    <button id="settle-btn" class="btn-settle" onclick="settle()">ğŸ¦ çµç®—ä¸¦å­˜å…¥éŠ€è¡Œ</button>
    <button class="btn-reset" onclick="resetToday()">æ¸…ç©ºä»Šæ—¥å‹¾é¸ (ä¸è¨ˆå…¥æ­·å²)</button>

    <strong class="history-title">ğŸ“œ æ­·å²å­˜æ‘ºç´€éŒ„</strong>
    <div id="history-content"></div>
</div>

<script>
    let currentChild = 'yujie';
    const config = {
        yujie: { name: 'ä¿æ½”', color: '#00796b', bg: '#e0f2f1' },
        yingan: { name: 'ç›ˆå®‰', color: '#673ab7', bg: '#ede7f6' }
    };

    function switchChild(id) {
        currentChild = id;
        // åˆ‡æ›æ¨£å¼
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.getElementById('tab-' + id).classList.add('active');
        
        const c = config[id];
        document.documentElement.style.setProperty('--main-color', c.color);
        document.documentElement.style.setProperty('--bg-color', c.bg);
        document.getElementById('child-title').innerText = c.name + " çš„é›†é»å¡";
        document.getElementById('child-title').style.color = c.color;
        
        resetToday(); 
        loadData();
    }

    function updateScore() {
        let score = 0;
        document.querySelectorAll('.cb').forEach(cb => { if(cb.checked) score += parseInt(cb.dataset.pts); });
        document.getElementById('total-score').innerText = score;
    }

    function settle() {
        let score = parseInt(document.getElementById('total-score').innerText);
        if(score === 0) return alert("é‚„æ²’æœ‰é»æ•¸å¯ä»¥çµç®—å–”ï¼");

        let used = prompt(`ã€${config[currentChild].name}ã€‘æœ¬é€±ç²å¾— ${score} é»ã€‚\nè¦æ‰£é™¤å¤šå°‘é»æ›çå‹µï¼Ÿ(ä¸æ›å¡«0)`, "0");
        if (used === null) return;
        
        let remain = score - parseInt(used);
        if (remain < 0) return alert("é»æ•¸ä¸è¶³ï¼");

        let date = new Date().toLocaleDateString();
        let record = { id: Date.now(), date, used, remain };
        
        let history = JSON.parse(localStorage.getItem(currentChild + '_logs') || "[]");
        history.unshift(record);
        localStorage.setItem(currentChild + '_logs', JSON.stringify(history));
        
        alert(`çµç®—æˆåŠŸï¼${remain} é»å·²å­˜å…¥ ${config[currentChild].name} çš„éŠ€è¡Œç´€éŒ„ã€‚`);
        resetToday();
        loadData();
    }

    function deleteLog(logId) {
        if(!confirm("ç¢ºå®šè¦åˆªé™¤é€™ç­†ç´€éŒ„å—ï¼Ÿé€™æœƒå½±éŸ¿éŠ€è¡Œç¸½é‡‘é¡å–”ï¼")) return;
        let history = JSON.parse(localStorage.getItem(currentChild + '_logs') || "[]");
        history = history.filter(item => item.id !== logId);
        localStorage.setItem(currentChild + '_logs', JSON.stringify(history));
        loadData();
    }

    function loadData() {
        let history = JSON.parse(localStorage.getItem(currentChild + '_logs') || "[]");
        let balance = 0;
        let html = "";
        
        history.forEach(log => {
            balance += parseInt(log.remain);
            html += `<div class="history-item">
                        <span>ğŸ“… ${log.date}<br><small>æ‰£é™¤çå‹µï¼š${log.used} | <b>å‰©é¤˜ï¼š${log.remain}</b></small></span>
                        <span class="del-btn" onclick="deleteLog(${log.id})">âŒ åˆªé™¤</span>
                     </div>`;
        });
        
        document.getElementById('bank-val').innerText = balance;
        document.getElementById('history-content').innerHTML = html || "<p style='color:grey; font-size:0.8em;'>å°šç„¡æ­·å²ç´€éŒ„</p>";
    }

    function resetToday() {
        document.querySelectorAll('.cb').forEach(cb => cb.checked = false);
        updateScore();
    }

    document.querySelectorAll('.cb').forEach(cb => cb.addEventListener('change', updateScore));
    window.onload = () => loadData();
</script>

</body>
</html>

