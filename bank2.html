<!DOCTYPE html>
<html lang="zh-Hant">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>å®¶åº­é›†é»éŠ€è¡Œ</title>
   <style>
       body { font-family: -apple-system, sans-serif; background: #fdf6e3; padding: 15px; color: #444; }
       .card { max-width: 500px; margin: auto; background: white; padding: 20px; border-radius: 20px; box-shadow: 0 10px 20px rgba(0,0,0,0.05); }
       h2 { text-align: center; color: #d35400; border-bottom: 2px solid #f39c12; padding-bottom: 10px; }
       .item { display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid #eee; }
       .pts { color: #e67e22; font-weight: bold; margin-right: 8px; }
       .score-zone { text-align: center; background: #fff3e0; padding: 15px; border-radius: 15px; margin: 20px 0; }
       #total-score { font-size: 2em; color: #e67e22; display: block; }
       .reward-info { background: #e8f5e9; padding: 10px; border-radius: 10px; font-size: 0.9em; margin-bottom: 15px; border-left: 5px solid #4caf50; }
       .history { margin-top: 20px; padding-top: 15px; border-top: 2px dashed #ccc; font-size: 0.85em; }
       button { width: 100%; padding: 12px; border: none; border-radius: 10px; font-size: 16px; cursor: pointer; transition: 0.3s; }
       .btn-calc { background: #3498db; color: white; margin-bottom: 10px; }
       .btn-reset { background: #ecf0f1; color: #7f8c8d; }
       input[type="checkbox"] { transform: scale(1.5); }
   </style>
</head>
<body>

<div class="card">
   <h2>ğŸ† ç›ˆå®‰çš„é›†é»éŠ€è¡Œ</h2>
   
   <div class="reward-info">
       ğŸ“º 10é» = é›»è¦–30åˆ† | ğŸ“± 30é» = å¹³æ¿1å°æ™‚<br>
       ğŸ’° å‰©é¤˜é»æ•¸ï¼š1é» = 1å…ƒç¾é‡‘
   </div>

   <div id="task-list">
       <div class="item"><span>æ”¶æ‹¾ç©å…·</span><div><span class="pts">+1</span><input type="checkbox" class="cb" data-pts="1"></div></div>
       <div class="item"><span>æ•´ç†æ›¸åŒ…</span><div><span class="pts">+1</span><input type="checkbox" class="cb" data-pts="1"></div></div>
       <div class="item"><span>é¤ç›¤æ”¾æ°´æ§½</span><div><span class="pts">+1</span><input type="checkbox" class="cb" data-pts="1"></div></div>
       <div class="item"><span>ä¾¿ç•¶æ”¾æ°´æ§½</span><div><span class="pts">+1</span><input type="checkbox" class="cb" data-pts="1"></div></div>
       <div class="item"><span>è«‹å®¶é•·ç°½å</span><div><span class="pts">+1</span><input type="checkbox" class="cb" data-pts="1"></div></div>
       <div class="item"><span>20:00å‰å®Œæˆä½œæ¥­</span><div><span class="pts">+1</span><input type="checkbox" class="cb" data-pts="1"></div></div>
       <div class="item"><span>é ç¿’åŠŸèª²</span><div><span class="pts">+2</span><input type="checkbox" class="cb" data-pts="2"></div></div>
       <div class="item"><span>è®€å®Œ2æœ¬èª²å¤–æ›¸(é€±)</span><div><span class="pts">+2</span><input type="checkbox" class="cb" data-pts="2"></div></div>
       <div class="item"><span>å®Œæˆè‡ªä¿®ä¸€å–®å…ƒ(é€±)</span><div><span class="pts">+2</span><input type="checkbox" class="cb" data-pts="2"></div></div>
   </div>

   <div class="score-zone">
       æœ¬é€±ç›®å‰ç´¯è¨ˆ
       <span id="total-score">0</span>
       <small id="reward-hint" style="color:#7f8c8d"></small>
   </div>

   <button class="btn-calc" onclick="settleWeek()">ğŸ’° é€±æ—¥çµç®— (å­˜å…¥å­˜æ‘º)</button>
   <button class="btn-reset" onclick="resetToday()">æ¸…ç©ºç•¶æ—¥å‹¾é¸</button>

   <div class="history">
       <strong>ğŸ“œ æ­·å²å­˜æ‘ºç´€éŒ„ï¼š</strong>
       <div id="history-content">å°šç„¡ç´€éŒ„</div>
   </div>
</div>

<script>
   const checkboxes = document.querySelectorAll('.cb');
   const scoreText = document.getElementById('total-score');
   const hintText = document.getElementById('reward-hint');
   const historyDiv = document.getElementById('history-content');

   // å³æ™‚è¨ˆç®—åˆ†æ•¸
   function updateScore() {
       let score = 0;
       checkboxes.forEach(cb => { if(cb.checked) score += parseInt(cb.dataset.pts); });
       scoreText.innerText = score;
       
       if(score >= 30) hintText.innerText = "ğŸ‰ é”æ¨™ï¼å¯æ›å¹³æ¿å›‰";
       else if(score >= 10) hintText.innerText = "ğŸ“º é”æ¨™ï¼å¯çœ‹é›»è¦–å›‰";
       else hintText.innerText = `é‚„å·® ${10-score} é»å¯æ›é›»è¦–`;
   }

   // çµç®—åŠŸèƒ½
   function settleWeek() {
       let currentScore = parseInt(scoreText.innerText);
       if(currentScore === 0) return alert("ç›®å‰é‚„æ²’æœ‰é»æ•¸å–”ï¼");

       let used = prompt(`æœ¬é€±ç¸½è¨ˆ ${currentScore} é»ã€‚\nè«‹å•è¦æ‰£é™¤å¤šå°‘é»å…Œæ›çå‹µï¼Ÿ(è‹¥ä¸å…Œæ›è«‹å¡«0)`, "0");
       if (used === null) return;
       
       let remaining = currentScore - parseInt(used);
       if (remaining < 0) return alert("é»æ•¸ä¸è¶³ä»¥å…Œæ›å–”ï¼");

       let date = new Date().toLocaleDateString();
       let log = `<div>ğŸ“ ${date}: æ›çæ‰£ ${used}ï¼Œå‰©é¤˜ ${remaining} é» (å¯é ˜ ${remaining} å…ƒ)</div>`;
       
       // å„²å­˜åˆ°æ­·å²
       let history = localStorage.getItem('point_history') || "";
       localStorage.setItem('point_history', log + history);
       
       alert(`çµç®—æˆåŠŸï¼å·²å°‡ ${remaining} é»å­˜å…¥å­˜æ‘ºã€‚`);
       resetToday();
       loadHistory();
   }

   function resetToday() {
       checkboxes.forEach(cb => cb.checked = false);
       updateScore();
   }

   function loadHistory() {
       const saved = localStorage.getItem('point_history');
       if(saved) historyDiv.innerHTML = saved;
   }

   checkboxes.forEach(cb => cb.addEventListener('change', updateScore));
   window.onload = loadHistory;
</script>

</body>
</html>
